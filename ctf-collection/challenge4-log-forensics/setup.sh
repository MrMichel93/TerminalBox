#!/bin/bash

# Challenge 4: Log File Forensics - Setup Script

echo "Setting up Challenge 4: Log File Forensics..."

# Generate a realistic web server access log with the flag hidden inside
cat > access.log << 'EOF'
192.168.1.100 - - [15/Dec/2024:10:23:45 +0000] "GET /index.html HTTP/1.1" 200 1234 "-" "Mozilla/5.0"
192.168.1.101 - - [15/Dec/2024:10:24:12 +0000] "GET /about.html HTTP/1.1" 200 2345 "-" "Mozilla/5.0"
10.0.0.50 - - [15/Dec/2024:10:25:33 +0000] "POST /api/login HTTP/1.1" 200 156 "-" "curl/7.68.0"
192.168.1.102 - - [15/Dec/2024:10:26:01 +0000] "GET /images/logo.png HTTP/1.1" 200 45678 "-" "Mozilla/5.0"
192.168.1.103 - - [15/Dec/2024:10:27:15 +0000] "GET /contact.html HTTP/1.1" 200 1987 "-" "Mozilla/5.0"
172.16.0.20 - - [15/Dec/2024:10:28:42 +0000] "GET /admin HTTP/1.1" 404 162 "-" "Mozilla/5.0"
192.168.1.104 - - [15/Dec/2024:10:29:18 +0000] "GET /products.html HTTP/1.1" 200 3456 "-" "Mozilla/5.0"
10.0.0.51 - - [15/Dec/2024:10:30:05 +0000] "GET /api/users HTTP/1.1" 200 8765 "-" "Python-requests/2.25.1"
192.168.1.105 - - [15/Dec/2024:10:31:22 +0000] "GET /services.html HTTP/1.1" 200 2876 "-" "Mozilla/5.0"
192.168.1.106 - - [15/Dec/2024:10:32:44 +0000] "POST /api/submit HTTP/1.1" 201 89 "-" "Mozilla/5.0"
192.168.1.107 - - [15/Dec/2024:10:33:19 +0000] "GET /blog/post1 HTTP/1.1" 200 4532 "-" "Mozilla/5.0"
172.16.0.21 - - [15/Dec/2024:10:34:55 +0000] "GET /login HTTP/1.1" 200 1765 "-" "Mozilla/5.0"
192.168.1.108 - - [15/Dec/2024:10:35:31 +0000] "GET /static/style.css HTTP/1.1" 200 12345 "-" "Mozilla/5.0"
10.0.0.52 - - [15/Dec/2024:10:36:08 +0000] "GET /api/data HTTP/1.1" 200 5643 "-" "curl/7.68.0"
192.168.1.109 - - [15/Dec/2024:10:37:42 +0000] "GET /gallery.html HTTP/1.1" 200 8765 "-" "Mozilla/5.0"
192.168.1.110 - - [15/Dec/2024:10:38:15 +0000] "GET /faq.html HTTP/1.1" 200 3421 "-" "Mozilla/5.0"
10.0.0.53 - - [15/Dec/2024:10:39:27 +0000] "POST /api/update HTTP/1.1" 200 234 "-" "Python-requests/2.25.1"
192.168.1.111 - - [15/Dec/2024:10:40:03 +0000] "GET /privacy.html HTTP/1.1" 200 2198 "-" "Mozilla/5.0"
192.168.1.112 - - [15/Dec/2024:10:41:38 +0000] "GET /download/file.pdf HTTP/1.1" 200 987654 "-" "Mozilla/5.0"
172.16.0.22 - - [15/Dec/2024:10:42:51 +0000] "GET /admin/panel HTTP/1.1" 403 143 "-" "Mozilla/5.0"
192.168.1.113 - - [15/Dec/2024:10:43:14 +0000] "GET /news.html HTTP/1.1" 200 4567 "-" "Mozilla/5.0"
10.0.0.54 - - [15/Dec/2024:10:44:29 +0000] "GET /api/status HTTP/1.1" 200 123 "-" "curl/7.68.0"
192.168.1.114 - - [15/Dec/2024:10:45:02 +0000] "GET /careers.html HTTP/1.1" 200 3210 "-" "Mozilla/5.0"
192.168.1.115 - - [15/Dec/2024:10:46:37 +0000] "POST /search?q=test HTTP/1.1" 200 2345 "-" "Mozilla/5.0"
192.168.1.116 - - [15/Dec/2024:10:47:11 +0000] "GET /portfolio.html HTTP/1.1" 200 5432 "-" "Mozilla/5.0"
10.0.0.55 - - [15/Dec/2024:10:48:45 +0000] "GET /secret_endpoint?data=FLAG{l0g_f1l3_f0r3ns1cs_3xp3rt} HTTP/1.1" 200 89 "-" "SuspiciousBot/1.0"
192.168.1.117 - - [15/Dec/2024:10:49:18 +0000] "GET /team.html HTTP/1.1" 200 3987 "-" "Mozilla/5.0"
192.168.1.118 - - [15/Dec/2024:10:50:33 +0000] "GET /testimonials.html HTTP/1.1" 200 4123 "-" "Mozilla/5.0"
172.16.0.23 - - [15/Dec/2024:10:51:06 +0000] "GET /robots.txt HTTP/1.1" 200 87 "-" "Googlebot/2.1"
192.168.1.119 - - [15/Dec/2024:10:52:41 +0000] "GET /sitemap.xml HTTP/1.1" 200 2456 "-" "Bingbot/2.0"
192.168.1.120 - - [15/Dec/2024:10:53:15 +0000] "POST /api/feedback HTTP/1.1" 201 156 "-" "Mozilla/5.0"
10.0.0.56 - - [15/Dec/2024:10:54:28 +0000] "GET /api/metrics HTTP/1.1" 200 9876 "-" "Python-requests/2.25.1"
192.168.1.121 - - [15/Dec/2024:10:55:02 +0000] "GET /features.html HTTP/1.1" 200 4321 "-" "Mozilla/5.0"
192.168.1.122 - - [15/Dec/2024:10:56:37 +0000] "GET /pricing.html HTTP/1.1" 200 3654 "-" "Mozilla/5.0"
192.168.1.123 - - [15/Dec/2024:10:57:11 +0000] "GET /support.html HTTP/1.1" 200 2987 "-" "Mozilla/5.0"
172.16.0.24 - - [15/Dec/2024:10:58:45 +0000] "GET /backup.zip HTTP/1.1" 404 162 "-" "Mozilla/5.0"
192.168.1.124 - - [15/Dec/2024:10:59:19 +0000] "GET /compare.html HTTP/1.1" 200 5123 "-" "Mozilla/5.0"
192.168.1.125 - - [15/Dec/2024:11:00:33 +0000] "GET /documentation.html HTTP/1.1" 200 8765 "-" "Mozilla/5.0"
10.0.0.57 - - [15/Dec/2024:11:01:07 +0000] "POST /api/webhook HTTP/1.1" 200 45 "-" "GitHub-Hookshot/abc123"
192.168.1.126 - - [15/Dec/2024:11:02:42 +0000] "GET /changelog.html HTTP/1.1" 200 3456 "-" "Mozilla/5.0"
192.168.1.127 - - [15/Dec/2024:11:03:16 +0000] "GET /terms.html HTTP/1.1" 200 6789 "-" "Mozilla/5.0"
EOF

echo "Setup complete!"
echo ""
echo "A log file 'access.log' has been generated with 40 entries."
echo "Your mission: Find the flag hidden in the log file."
echo ""
echo "Hints:"
echo "  - The flag is in the standard FLAG{...} format"
echo "  - Look for suspicious requests or unusual patterns"
echo "  - Use grep, awk, and other text processing tools"
echo ""
echo "Start your investigation with: cat access.log"
